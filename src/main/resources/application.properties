spring.application.name=tiquetera-catalog

# ============ Profile Configuration ============
# Active profile: dev (H2), mysql (MySQL), test (H2 for tests)
# Override with: -Dspring.profiles.active=mysql
spring.profiles.active=dev

# Configuracion de servidor
server.port=8080

# ============ Flyway Configuration ============
# Enable Flyway for database migrations
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true

# ============ JPA/Hibernate Configuration ============
# Let Flyway handle schema creation (not Hibernate)
spring.jpa.hibernate.ddl-auto=validate

# ============ SQL Logging for Performance Analysis ============
# Show SQL statements
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Generate statistics for query analysis
spring.jpa.properties.hibernate.generate_statistics=true

# Log slow queries (threshold in milliseconds)
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=25

# Batch size for N+1 optimization
spring.jpa.properties.hibernate.default_batch_fetch_size=20

# Use batch loading for collections
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# ============ Logging Configuration ============
logging.level.root=INFO
logging.level.com.codeup.riwi.tiqueteracatalogo=DEBUG

# SQL Logging for debugging N+1 issues
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.hibernate.stat=DEBUG

# Flyway logging
logging.level.org.flywaydb=INFO

# Spring Data JPA logging
logging.level.org.springframework.data.jpa=DEBUG

# Transaction logging (useful for debugging)
logging.level.org.springframework.transaction=DEBUG
logging.level.org.springframework.orm.jpa=DEBUG

# Connection pool logging
logging.level.com.zaxxer.hikari=DEBUG

# Reduce warnings de excepciones manejadas (404, 400)
logging.level.org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver=ERROR

spring.web.resources.add-mappings=false

# ============ Performance Tuning ============
# Open session in view (disable for better performance in production)
spring.jpa.open-in-view=false